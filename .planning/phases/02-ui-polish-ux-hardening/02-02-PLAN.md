---
phase: 02-ui-polish-ux-hardening
plan: 02
type: execute
wave: 2
depends_on: ["02-01"]
files_modified:
  - mobile/src/screens/dashboard/DashboardScreen.tsx
  - mobile/src/screens/clients/ClientListScreen.tsx
  - mobile/src/screens/clients/ClientDetailScreen.tsx
  - mobile/src/screens/calendar/CalendarScreen.tsx
  - mobile/src/screens/calendar/SessionDetailScreen.tsx
  - mobile/src/screens/exercises/ExerciseListScreen.tsx
  - mobile/src/screens/messages/ConversationListScreen.tsx
  - mobile/src/screens/messages/ChatScreen.tsx
  - mobile/src/screens/settings/NotificationSettingsScreen.tsx
  - mobile/src/screens/workouts/TemplateListScreen.tsx
autonomous: true

must_haves:
  truths:
    - "Every trainer screen with data fetching shows a centered spinner on initial load"
    - "Every trainer screen with data fetching shows an error message with a Retry button when the query fails"
    - "ConversationListScreen shows a helpful empty state with icon when there are no conversations"
    - "ChatScreen shows a helpful empty state when there are no messages yet"
    - "No hardcoded hex colors exist outside theme.ts in any modified screen"
    - "All cards use consistent borderRadius from theme.borderRadius"
    - "All FABs use consistent shadow from theme.shadows"
  artifacts:
    - path: "mobile/src/screens/clients/ClientDetailScreen.tsx"
      provides: "Error state with retry button"
      contains: "onRetry"
    - path: "mobile/src/screens/calendar/CalendarScreen.tsx"
      provides: "Error state with retry button, consistent FAB shadow"
      contains: "shadows"
    - path: "mobile/src/screens/messages/ConversationListScreen.tsx"
      provides: "Error handling and improved empty state"
      contains: "EmptyState"
    - path: "mobile/src/screens/messages/ChatScreen.tsx"
      provides: "Error handling and improved empty state"
      contains: "EmptyState"
  key_links:
    - from: "mobile/src/screens/clients/ClientDetailScreen.tsx"
      to: "mobile/src/components/ErrorState.tsx"
      via: "import"
      pattern: "import (ErrorState|ScreenContainer)"
    - from: "mobile/src/screens/messages/ConversationListScreen.tsx"
      to: "mobile/src/components/EmptyState.tsx"
      via: "import"
      pattern: "import EmptyState"
---

<objective>
Apply the shared UI components and extended theme to all trainer-side screens. Fix every error state to include a retry button, replace hardcoded colors with theme constants, standardize shadows and borderRadius, and add proper empty states to conversation/chat screens.

Purpose: After this plan, every trainer screen has consistent, professional styling and robust error handling. No screen looks like it belongs to a different app.
Output: 10 trainer screens updated with consistent components and theme tokens.
</objective>

<execution_context>
@/Users/dylanwagner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dylanwagner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-ui-polish-ux-hardening/02-RESEARCH.md
@.planning/phases/02-ui-polish-ux-hardening/02-01-SUMMARY.md
@mobile/src/theme.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix error/empty states and styling on core trainer screens (Dashboard, ClientList, ClientDetail, Calendar, SessionDetail)</name>
  <files>
    mobile/src/screens/dashboard/DashboardScreen.tsx
    mobile/src/screens/clients/ClientListScreen.tsx
    mobile/src/screens/clients/ClientDetailScreen.tsx
    mobile/src/screens/calendar/CalendarScreen.tsx
    mobile/src/screens/calendar/SessionDetailScreen.tsx
  </files>
  <action>
    For each screen, apply these changes. Read each file first to understand current structure before editing.

    **DashboardScreen.tsx** (already has good error/loading -- just standardize styling):
    - Replace inline shadow objects on stat cards with `shadows.sm` from theme
    - Replace inline shadow objects on chart card with `shadows.md` from theme
    - Replace any hardcoded borderRadius values with `borderRadius.md` or `borderRadius.lg` from theme
    - Import `shadows, borderRadius` from theme
    - Keep existing error/loading pattern (it's already the best one) OR replace with ScreenContainer if it simplifies the code. Either way, keep RefreshControl working (ScreenContainer only handles initial isLoading, not isRefetching).

    **ClientListScreen.tsx**:
    - Replace hardcoded `#DCFCE7` with `colors.successLight`
    - Replace hardcoded `#F1F5F9` with `colors.backgroundAlt`
    - Replace any other hardcoded hex/rgba colors with theme constants
    - Standardize card borderRadius to `borderRadius.lg`
    - Standardize shadows to `shadows.sm`
    - Error state already has retry -- verify it works, no changes needed if good

    **ClientDetailScreen.tsx**:
    - Replace `>` text chevron with Ionicons `chevron-forward` icon (size 16, colors.textSecondary). Import Ionicons from @expo/vector-icons.
    - ADD retry button to error state: Replace current error-only block with ErrorState component (or inline retry button matching the DashboardScreen pattern). Pass `refetch` as the retry handler.
    - Standardize any hardcoded borderRadius/shadow values

    **CalendarScreen.tsx**:
    - ADD retry button to error state: Use ErrorState component or add inline retry button with refetch
    - Standardize FAB shadow to `shadows.lg` from theme (currently has custom values that differ from other FABs)
    - Standardize card borderRadius values
    - Import `shadows, borderRadius` from theme

    **SessionDetailScreen.tsx**:
    - ADD retry button to error state: Use ErrorState component or add inline retry with refetch
    - Standardize any hardcoded shadow/borderRadius values

    **Pattern for adding error retry to screens that already have error text but no button:**
    Import ErrorState from components. Replace the existing error block:
    ```
    // Before:
    if (isError) return <View style={styles.center}><Text style={styles.errorText}>...</Text></View>

    // After:
    if (isError) return <ErrorState message="Failed to load [thing]" detail={error?.message} onRetry={refetch} />
    ```
    Or use ScreenContainer to wrap the whole screen if it simplifies the code (handles both loading and error).

    **Important:** Do NOT break RefreshControl. Screens using ScrollView with RefreshControl must keep that working. ScreenContainer only handles the initial `isLoading` state (when there's no cached data). Once data is loaded, RefreshControl handles pull-to-refresh independently via `isRefetching`.
  </action>
  <verify>
    Run `cd /Users/dylanwagner/Projects/my-app/mobile && npx tsc --noEmit` to verify compilation. Grep modified files for hardcoded hex colors (`#DCFCE7`, `#F1F5F9`, `shadowOpacity`) to confirm they've been replaced with theme constants.
  </verify>
  <done>
    DashboardScreen uses theme shadows/borderRadius. ClientListScreen has no hardcoded hex colors. ClientDetailScreen has chevron icon and error retry. CalendarScreen has consistent FAB shadow and error retry. SessionDetailScreen has error retry. All compile without errors.
  </done>
</task>

<task type="auto">
  <name>Task 2: Fix error/empty states and styling on utility trainer screens (ExerciseList, ConversationList, Chat, NotificationSettings, TemplateList)</name>
  <files>
    mobile/src/screens/exercises/ExerciseListScreen.tsx
    mobile/src/screens/messages/ConversationListScreen.tsx
    mobile/src/screens/messages/ChatScreen.tsx
    mobile/src/screens/settings/NotificationSettingsScreen.tsx
    mobile/src/screens/workouts/TemplateListScreen.tsx
  </files>
  <action>
    Read each file first, then apply changes.

    **ExerciseListScreen.tsx**:
    - ADD retry button to error state (currently shows error text only)
    - Use ErrorState component or add inline retry with refetch
    - Standardize any hardcoded shadow/borderRadius values

    **ConversationListScreen.tsx** (has NO error handling and WEAK empty state):
    - Add `isError, error, refetch` to the destructured query result (currently only destructures `data` and `isLoading`)
    - Add error handling: After the isLoading check, add `if (isError) return <ErrorState message="Failed to load conversations" onRetry={refetch} />`
    - Replace the minimal empty state ("No conversations yet" text only) with EmptyState component: `<EmptyState icon="chatbubbles-outline" title="No conversations yet" subtitle="Messages with your clients will appear here" />`
    - Import ErrorState and EmptyState from components

    **ChatScreen.tsx** (has NO error handling and WEAK empty state):
    - Add error and refetch to destructured query result
    - Add error handling block with ErrorState
    - Replace minimal empty state with EmptyState component: `<EmptyState icon="chatbubble-outline" title="Start a conversation" subtitle="Send a message to begin chatting" />`
    - Import ErrorState and EmptyState

    **NotificationSettingsScreen.tsx** (has NO error handling):
    - Add isError, error, refetch to destructured query result
    - Add error handling with ErrorState component
    - Import ErrorState

    **TemplateListScreen.tsx** (already has good error + empty states):
    - Verify error state has retry (research says it does -- confirm)
    - Standardize any hardcoded shadow/borderRadius values to theme constants
    - Only make changes if actual inconsistencies found

    **For all screens:** Replace any remaining hardcoded hex/rgba color values with theme constants. Standardize borderRadius to use theme.borderRadius values.
  </action>
  <verify>
    Run `cd /Users/dylanwagner/Projects/my-app/mobile && npx tsc --noEmit`. Grep ConversationListScreen.tsx and ChatScreen.tsx for "ErrorState" and "EmptyState" imports to confirm they were added. Grep NotificationSettingsScreen.tsx for "ErrorState" or "onRetry" to confirm error handling was added.
  </verify>
  <done>
    ExerciseListScreen has error retry. ConversationListScreen has error handling AND improved empty state with icon/subtitle. ChatScreen has error handling AND improved empty state. NotificationSettingsScreen has error handling. TemplateListScreen shadows/borderRadius are standardized. All compile without errors.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in mobile/ directory
2. No screen in the modified list shows error text without a retry mechanism
3. ConversationListScreen and ChatScreen have both ErrorState and EmptyState components
4. NotificationSettingsScreen handles errors
5. No hardcoded `#DCFCE7`, `#F1F5F9` remain in modified files
6. FAB shadows are consistent (all use theme.shadows.lg)
</verification>

<success_criteria>
- All 10 trainer screens have consistent error handling with retry capability
- Hardcoded colors replaced with theme constants
- Shadows and borderRadius standardized across all modified screens
- ConversationListScreen and ChatScreen have rich empty states with icons and helpful text
- TypeScript compilation succeeds
</success_criteria>

<output>
After completion, create `.planning/phases/02-ui-polish-ux-hardening/02-02-SUMMARY.md`
</output>
