---
phase: 02-ui-polish-ux-hardening
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - mobile/src/theme.ts
  - mobile/src/components/ScreenContainer.tsx
  - mobile/src/components/LoadingState.tsx
  - mobile/src/components/ErrorState.tsx
  - mobile/src/components/EmptyState.tsx
  - mobile/src/components/FormField.tsx
  - mobile/src/components/NetworkBanner.tsx
  - mobile/src/hooks/useNetworkStatus.ts
  - mobile/App.tsx
autonomous: true

must_haves:
  truths:
    - "Importing ScreenContainer, LoadingState, ErrorState, EmptyState, FormField, NetworkBanner from mobile/src/components works without error"
    - "theme.ts exports colors (with primaryLight, successLight, backgroundAlt), spacing, fontSize, borderRadius, and shadows objects"
    - "Tab bar shows consistent vector icons instead of emoji"
    - "useNetworkStatus hook returns isConnected and isOffline booleans"
  artifacts:
    - path: "mobile/src/theme.ts"
      provides: "Extended design tokens: colors (15), spacing (5), fontSize (5), borderRadius (6), shadows (3)"
      contains: "borderRadius"
    - path: "mobile/src/components/ScreenContainer.tsx"
      provides: "Wrapper handling isLoading/isError/children lifecycle"
      exports: ["default"]
    - path: "mobile/src/components/LoadingState.tsx"
      provides: "Centered ActivityIndicator with theme colors"
      exports: ["default"]
    - path: "mobile/src/components/ErrorState.tsx"
      provides: "Error message + optional detail + retry button"
      exports: ["default"]
    - path: "mobile/src/components/EmptyState.tsx"
      provides: "Icon + title + subtitle + optional CTA button"
      exports: ["default"]
    - path: "mobile/src/components/FormField.tsx"
      provides: "Label + TextInput + inline error message"
      exports: ["default"]
    - path: "mobile/src/components/NetworkBanner.tsx"
      provides: "Offline banner using NetInfo with debounce"
      exports: ["default"]
    - path: "mobile/src/hooks/useNetworkStatus.ts"
      provides: "Network connectivity hook"
      exports: ["useNetworkStatus"]
  key_links:
    - from: "mobile/src/components/ScreenContainer.tsx"
      to: "mobile/src/components/LoadingState.tsx"
      via: "import"
      pattern: "import LoadingState"
    - from: "mobile/src/components/ScreenContainer.tsx"
      to: "mobile/src/components/ErrorState.tsx"
      via: "import"
      pattern: "import ErrorState"
    - from: "mobile/src/components/NetworkBanner.tsx"
      to: "@react-native-community/netinfo"
      via: "import"
      pattern: "import NetInfo"
    - from: "mobile/App.tsx"
      to: "@expo/vector-icons"
      via: "import for tab icons"
      pattern: "import.*Ionicons"
---

<objective>
Create the design system foundation: extend theme.ts with shadows, borderRadius, and additional named colors; build all 6 shared UI components (ScreenContainer, LoadingState, ErrorState, EmptyState, FormField, NetworkBanner); create useNetworkStatus hook; install @react-native-community/netinfo; and replace emoji tab icons with Ionicons.

Purpose: Every subsequent plan depends on these shared components and theme tokens. This is the foundation layer that enables consistent, parallel screen updates.
Output: Extended theme.ts, 6 new components, 1 new hook, netinfo installed, tab icons using Ionicons.
</objective>

<execution_context>
@/Users/dylanwagner/.claude/get-shit-done/workflows/execute-plan.md
@/Users/dylanwagner/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/02-ui-polish-ux-hardening/02-RESEARCH.md
@mobile/src/theme.ts
@mobile/App.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Extend theme.ts and create all shared UI components + network hook</name>
  <files>
    mobile/src/theme.ts
    mobile/src/components/ScreenContainer.tsx
    mobile/src/components/LoadingState.tsx
    mobile/src/components/ErrorState.tsx
    mobile/src/components/EmptyState.tsx
    mobile/src/components/FormField.tsx
    mobile/src/components/NetworkBanner.tsx
    mobile/src/hooks/useNetworkStatus.ts
  </files>
  <action>
    1. Install @react-native-community/netinfo:
       ```
       cd mobile && npx expo install @react-native-community/netinfo
       ```

    2. Extend `mobile/src/theme.ts` -- keep ALL existing exports unchanged, ADD:
       - `colors.primaryLight: "#EFF6FF"` (for selected/highlighted states)
       - `colors.successLight: "#DCFCE7"` (for active status chips)
       - `colors.backgroundAlt: "#F1F5F9"` (for inactive status chips)
       - `borderRadius` object: `{ sm: 6, md: 8, lg: 10, xl: 12, pill: 16, full: 9999 }`
       - `shadows` object with `sm`, `md`, `lg` presets (each has shadowColor, shadowOffset, shadowOpacity, shadowRadius, elevation). Use the values from 02-RESEARCH.md code examples section.

    3. Create `mobile/src/components/LoadingState.tsx`:
       - Centered ActivityIndicator (size="large", color=colors.primary) in a flex:1 View with colors.background
       - Default export

    4. Create `mobile/src/components/ErrorState.tsx`:
       - Props: `{ message?: string; detail?: string; onRetry?: () => void }`
       - Shows "Something went wrong" as default message in colors.danger
       - Optional detail text in colors.textSecondary below
       - Optional "Retry" button (colors.primary background, white text, borderRadius.md) when onRetry provided
       - All centered, padding spacing.xl, backgroundColor colors.background
       - Use the exact implementation from 02-RESEARCH.md (use borderRadius.md instead of hardcoded 8)

    5. Create `mobile/src/components/EmptyState.tsx`:
       - Props: `{ icon?: string; title: string; subtitle?: string; actionLabel?: string; onAction?: () => void }`
       - `icon` is an Ionicons icon name (e.g., "chatbubbles-outline") rendered at size 48, colors.disabled
       - Title in fontSize.lg, fontWeight 600, colors.textSecondary
       - Optional subtitle in fontSize.sm, colors.disabled
       - Optional action button (colors.primary background, white text) when both actionLabel and onAction provided
       - All centered, padding spacing.xl
       - Import Ionicons from @expo/vector-icons

    6. Create `mobile/src/components/ScreenContainer.tsx`:
       - Props: `{ isLoading: boolean; isError: boolean; error?: Error | null; onRetry?: () => void; children: React.ReactNode }`
       - If isLoading, render LoadingState
       - If isError, render ErrorState with error?.message and onRetry
       - Otherwise render children in a flex:1 View with colors.background
       - Import LoadingState and ErrorState from sibling files

    7. Create `mobile/src/components/FormField.tsx`:
       - Props extend TextInputProps: `{ label: string; error?: string; required?: boolean }`
       - Label text: fontSize.sm, fontWeight 600, colors.text, marginBottom spacing.xs. Append " *" if required.
       - TextInput: colors.surface background, 1px colors.border border, borderRadius.md, padding spacing.md horizontal and spacing.sm+2 vertical, fontSize.md, colors.text
       - When error is truthy: border turns colors.danger, red error text (fontSize.sm, colors.danger) appears below input with marginTop spacing.xs
       - placeholderTextColor: colors.disabled
       - Container: marginBottom spacing.md

    8. Create `mobile/src/hooks/useNetworkStatus.ts`:
       - Uses NetInfo.addEventListener to track connectivity
       - State: `isConnected` (boolean | null, default true)
       - Returns `{ isConnected, isOffline: isConnected === false }`
       - Cleanup: unsubscribe on unmount

    9. Create `mobile/src/components/NetworkBanner.tsx`:
       - Uses useNetworkStatus hook
       - When isOffline is true AND has been offline for > 1 second (debounce with setTimeout/useRef), render a banner:
         - Full width, backgroundColor colors.danger, paddingVertical spacing.sm, paddingHorizontal spacing.md
         - Text "No internet connection" in white, fontSize.sm, fontWeight 600, textAlign center
       - When online, render null
       - The 1-second debounce prevents flickering during network transitions (per research pitfall #3)
  </action>
  <verify>
    Run `cd /Users/dylanwagner/Projects/my-app/mobile && npx tsc --noEmit` to verify all files compile without TypeScript errors. Check that @react-native-community/netinfo is in package.json dependencies.
  </verify>
  <done>
    theme.ts exports colors (15 named), spacing (5), fontSize (5), borderRadius (6), shadows (3). All 6 components and 1 hook exist, compile, and export correctly. netinfo is installed.
  </done>
</task>

<task type="auto">
  <name>Task 2: Replace emoji tab icons with Ionicons in App.tsx</name>
  <files>mobile/App.tsx</files>
  <action>
    Replace the emoji-based TabIcon system in App.tsx with Ionicons from @expo/vector-icons (already bundled with Expo SDK 54, no install needed).

    1. Add import: `import { Ionicons } from '@expo/vector-icons';`

    2. Replace the `TabIcon` function. Instead of emoji lookup, use Ionicons with outline/filled variants:
       ```
       Icon mappings:
       Home     -> focused: "home"         unfocused: "home-outline"
       Clients  -> focused: "people"       unfocused: "people-outline"
       Calendar -> focused: "calendar"     unfocused: "calendar-outline"
       Workouts -> focused: "barbell"      unfocused: "barbell-outline"
       Exercises-> focused: "book"         unfocused: "book-outline"
       Messages -> focused: "chatbubbles"  unfocused: "chatbubbles-outline"
       Sessions -> focused: "calendar"     unfocused: "calendar-outline"
       Progress -> focused: "trending-up"  unfocused: "trending-up-outline"
       Logs     -> focused: "clipboard"    unfocused: "clipboard-outline"
       ```
       Size: 24, color: focused ? colors.primary : colors.secondary

    3. Update `MessagesTabIcon` to also use Ionicons instead of emoji "chatbubbles" / "chatbubbles-outline".

    4. Make sure the tabBarIcon callback receives `{ focused, color, size }` and passes color/size through. Remove the old emoji-based opacity styling.

    5. Do NOT add NetworkBanner to App.tsx yet -- that happens in Plan 03 when client screens are updated.
  </action>
  <verify>
    Run `cd /Users/dylanwagner/Projects/my-app/mobile && npx tsc --noEmit` to confirm no TypeScript errors. Visually confirm by searching for any remaining emoji strings in App.tsx (there should be none in the tab icon section).
  </verify>
  <done>
    All tab icons render as Ionicons vectors instead of emoji strings. Both TrainerTabs and ClientTabs use the new icon system. No emoji characters remain in tab icon code.
  </done>
</task>

</tasks>

<verification>
1. `npx tsc --noEmit` passes in mobile/ directory
2. All 6 new component files exist in mobile/src/components/
3. mobile/src/hooks/useNetworkStatus.ts exists
4. theme.ts exports borderRadius and shadows objects
5. App.tsx imports Ionicons, no emoji strings in tab icon code
6. @react-native-community/netinfo appears in mobile/package.json
</verification>

<success_criteria>
- theme.ts has 15 named colors, borderRadius (6 sizes), and shadows (3 presets)
- All shared components (ScreenContainer, LoadingState, ErrorState, EmptyState, FormField, NetworkBanner) exist and compile
- useNetworkStatus hook exists and compiles
- Tab icons use Ionicons instead of emoji
- TypeScript compilation succeeds with no errors
</success_criteria>

<output>
After completion, create `.planning/phases/02-ui-polish-ux-hardening/02-01-SUMMARY.md`
</output>
